# Workflow przed Commitem (WYMAGANE)

## Przed każdym commitem MUSISZ uruchomić i naprawić:

### 1. Laravel Pint (formatowanie)
```bash
cd api && vendor/bin/pint
```

### 2. PHPStan (analiza statyczna)
```bash
cd api && vendor/bin/phpstan analyse --memory-limit=2G
```
Poziom: 5. Zero błędów przed commitem.

### 3. PHPUnit (testy)
```bash
cd api && php artisan test
```
Wszystkie testy muszą przechodzić.

### 4. GitLeaks (sekrety)
```bash
gitleaks protect --source . --verbose --no-banner
```
Zero wykrytych sekretów.

### 5. Composer Audit (bezpieczeństwo)
```bash
cd api && composer audit
```
Napraw krytyczne luki przed commitem.

### 6. Aktualizacja Dokumentacji API (jeśli zmieniono endpointy)
**WAŻNE:** Jeśli dodano/zmieniono/usunięto endpointy API, **ZAWSZE** zaktualizuj:

#### OpenAPI Spec
```bash
# Zaktualizuj docs/openapi.yaml
# Dodaj/zmień/usuń endpointy zgodnie ze zmianami w kodzie
```

#### Postman Collection
```bash
# Zaktualizuj docs/postman/moviemind-api.postman_collection.json
# Dodaj/zmień/usuń requesty zgodnie ze zmianami w API
```

#### Insomnia Collection
```bash
# Zaktualizuj docs/insomnia/moviemind-api-insomnia.json
# Dodaj/zmień/usuń requesty zgodnie ze zmianami w API
```

**Kiedy aktualizować:**
- ✅ Dodano nowy endpoint
- ✅ Zmieniono ścieżkę endpointu
- ✅ Zmieniono parametry requestu/response
- ✅ Usunięto endpoint
- ✅ Zmieniono status codes
- ✅ Dodano/zmieniono autoryzację

**Format aktualizacji:**
- OpenAPI: Zgodnie z formatem OpenAPI 3.0
- Postman: JSON format zgodny z Postman Collection v2.1
- Insomnia: JSON format zgodny z Insomnia Export

## Kompletny check (wszystko na raz)

```bash
cd api && \
  vendor/bin/pint && \
  vendor/bin/phpstan analyse --memory-limit=2G && \
  php artisan test && \
  gitleaks protect --source . --verbose --no-banner && \
  composer audit
```

**Pamiętaj:** Po zmianach w API zawsze zaktualizuj dokumentację!

## Branch Workflow (domyślna zasada)

- **90% zadań** realizuj na krótkich branchach feature (`feature/…`) obejmujących jeden spójny temat.
- Każdy branch kończ pull requestem do `main` (możesz zatwierdzić sam, ale PR i diff są obowiązkowe).
- `main` musi pozostać zawsze deployowalny; merguj tylko po przejściu testów/pre-commitów.
- Dłuższe, wielotygodniowe branche stosuj wyłącznie w wyjątkowych rekonstrukcjach — wtedy dziel pracę na mniejsze PR-y.

## Linki zewnętrzne i nazwy własne

- Przy podawaniu publicznie dostępnych nazw własnych (np. sklepy internetowe, dostawcy) **zawsze** dołącz obok wiarygodny link URL.
- Każdy link zewnętrzny **musisz zweryfikować** (otworzyć/testowo sprawdzić), aby upewnić się, że jest aktywny i prowadzi do właściwego źródła.
- Jeśli nie możesz potwierdzić linku, **wyraźnie to zaznacz**, dodając alternatywne źródło lub ostrzeżenie.
- Odpowiedzi formatuj przejrzyście (nagłówki, listy punktowane) zgodnie z guideline Cursor.
